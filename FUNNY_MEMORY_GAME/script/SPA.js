//SPA
var SPAState = {};
function switchToStateFromURLHash() {
  var URLHash = window.location.hash;
  var stateStr = URLHash.substr(1);
  if (stateStr != "") {
    SPAState = { pagename: stateStr }; 
  }
  else
    SPAState = { pagename: 'Main' }; 

  var pageHTML = "";
  switch (SPAState.pagename) {
    case 'Main':
      pageHTML += '<div class="wrapper_button"><button tabindex="1" id="btn_begin_play" onclick="switchToGamePage()">Start play</button><button tabindex="1" id="btn_records" onclick="switchToRecordsPage()">The best players</button><button  tabindex="1" id="btn_description" onclick="switchToDescriptionPage()">About game</button></div> <div class="main_pencil"><svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 450 900"><g id="face_pencil"><path fill="#ffffaa" stroke-width="1.5" stroke-opacity="null" d="m264.78271,205.77382l79.99777,-135.99693l79.99779,135.99693l-159.99556,0z" id="svg_9" stroke="#000" transform="rotate(35.49456024169922 344.7804870605469,137.7753601074219) "/><path stroke="#000" fill="#63635c" stroke-width="1.5" stroke-opacity="null" d="m369.907115,96.735616l9.074587,-13.99962l9.074595,13.99962l-18.149183,0z" id="svg_10" transform="rotate(35 378.98168945312506,89.73580932617182) "/><ellipse fill="#444440" stroke="#000" stroke-width="1.5" stroke-opacity="null" cx="127.006509" cy="859.429314" id="svg_19"/><ellipse fill="#000000" stroke-width="0" stroke-opacity="null" cx="323.001126" cy="125.449472" id="svg_27" rx="7.99978" ry="5.999835" transform="rotate(20 323.00115966796886,125.44949340820318) " stroke="#000"/><ellipse fill="#000000" stroke-width="0" stroke-opacity="null" cx="366.99992" cy="147.448869" id="svg_28" rx="7.99978" ry="5.999835" transform="rotate(28.354902267456055 366.99987792968744,147.44883728027347) " stroke="#000"/><ellipse fill="#e2e27f" stroke-width="1.5" stroke-opacity="null" cx="306.50657" cy="192.01075" id="svg_23" rx="78.819675" ry="12.299293" transform="rotate(35 306.5065612792968,192.0107574462891) " stroke="#000"/><ellipse fill="#fcf9f9" stroke="#000" stroke-width="0" stroke-opacity="null" cx="323.001126" cy="145.448924" id="svg_29"/><ellipse fill="#fcf9f9" stroke="#000" stroke-width="0" stroke-opacity="null" cx="357.000194" cy="131.449308" id="svg_30"/><ellipse fill="#ffffff" stroke-width="0" stroke-opacity="null" cx="366.99992" cy="147.448869" id="svg_31" rx="2" ry="3" transform="rotate(-12 366.99987792968756,147.4488220214843) " stroke="#000"/><ellipse fill="#ffffff" stroke-width="0" stroke-opacity="null" cx="325.001072" cy="127.449417" id="svg_32" rx="2" ry="3" transform="rotate(-12 325.0011596679687,127.44943237304666) " stroke="#000"/><path fill="none" stroke-width="1.5" stroke-opacity="null" id="svg_33" d="m359.00013,137.44915c0,0 0.58576,-0.58578 1.99994,-1.99995c1.41419,-1.41417 1.99993,-1.99994 3.99988,-1.99994c2,0 3.99994,0 5.99988,0c1.99994,0 3.99988,0 5.99982,0l1.99993,0l0,0" transform="rotate(30 368.9998168945313,135.44920349121097) " stroke="#000"/><path fill="none" stroke-width="1.5" stroke-opacity="null" id="svg_34" d="m325.00106,119.44965c0,-1.99996 1.99994,-1.99996 3.99989,-1.99996c1.99993,0 1.99993,-1.99994 3.99993,-1.99994l1.99994,0l8.99481,0" transform="rotate(40 334.4983520507812,117.44970703124996) " stroke="#000"/><ellipse fill="#f4f4cd" stroke="#000" stroke-width="0" stroke-opacity="null" cx="1082.996597" cy="301.446267" id="svg_36"/><path fill="#ffffff" stroke-width="1.5" stroke-opacity="null" d="m311.77886,143.36017l11.44946,0l0,0c6.32336,0 11.44946,10.99122 11.44946,24.54957c0,13.55835 -5.1261,24.54956 -11.44946,24.54956l-11.44946,0l0,-49.09913z" id="svg_37" transform="rotate(123.61577606201172 323.22833251953125,167.90972900390625) " stroke="#000"/></g><ellipse fill="#e08484" stroke-width="1.5" stroke-opacity="null" cx="285.00217" cy="884.428624" id="svg_20" rx="80" ry="19.000027" stroke="#000"/><rect fill="#7f0000" stroke-width="1.5" stroke-opacity="null" x="322.001262" y="256.87221" width="44.001164" height="535" id="svg_5" stroke="#000"/><ellipse fill="#7f0000" stroke-width="0" stroke-opacity="null" cx="344.000524" cy="265.536552" id="svg_7" rx="20.999411" ry="36.998989" stroke="#000"/><rect fill="#444440" stroke-width="1.5" stroke-opacity="null" x="205.004342" y="791.431182" width="39.998897" height="61.998297" id="svg_11" stroke="#000"/><rect fill="#63635c" stroke-width="1.5" stroke-opacity="null" x="245.003215" y="791.431182" width="75.997904" height="61.998297" id="svg_12" stroke="#000"/><rect fill="#444440" stroke-width="1.5" stroke-opacity="null" x="323.001109" y="791.431182" width="41.99884" height="61.998297" id="svg_13" stroke="#000"/><line fill="none" stroke="#939090" stroke-width="2.5" x1="205.004367" y1="805.430797" x2="364.999973" y2="805.430797" id="svg_14" stroke-linejoin="null" stroke-linecap="null"/><line fill="none" stroke-width="2.5" fill-opacity="0" x1="205.004367" y1="815.430523" x2="364.999973" y2="815.430523" id="svg_15" stroke-linejoin="null" stroke-linecap="null" stroke="#939090"/><line fill="none" stroke="#939090" stroke-width="2.5" x1="205.004367" y1="835.429975" x2="364.999973" y2="835.429975" id="svg_16" stroke-linejoin="null" stroke-linecap="null"/><line fill="none" stroke="#939090" stroke-width="2.5" x1="205.004367" y1="843.429755" x2="364.999973" y2="843.429755" id="svg_17" stroke-linejoin="null" stroke-linecap="null"/><rect fill="#fca1a1" stroke="#000" stroke-width="1.5" stroke-opacity="null" x="205.004367" y="851.429534" width="159.995606" height="35.999011" id="svg_18"/><text fill="#f7f722" stroke="#000000" stroke-width="1.5" id="svg_A" font-size="55" font-weight="bold" transform="rotate(-10.17487621307373 36.99999999999991,248.00000000000003) "><textpath xlink:href="#myPathA">A<animate attributeName="startOffset" from="0%" to ="100%" begin="0s" dur="5s" repeatCount="1" keyTimes="0;1" calcMode="spline" keySplines="0.1 0.2 .22 1"/></textpath></text><text fill="#00ff00" stroke="#000000" stroke-width="1.5" id="svg_41" font-size="55"  transform="rotate(-19.054046630859375 67.33593749999999,163.9375)"><textpath xlink:href="#myPathB">B<animate attributeName="startOffset" from="0%" to ="83%" begin="0s" dur="8s" repeatCount="1" fill="freeze" keyTimes="0;1" calcMode="spline" keySplines="0.1 0.2 .22 1"/></textpath></text><text fill="#0000ff" stroke="#000000" stroke-width="1.5" id="svg_42" font-size="55" >C</text><text fill="#e53d97" stroke="#000000" stroke-width="1.5" id="svg_45" font-size="55" transform="rotate(14.89669132232666 70.33593750000003,59.93749999999998)"><textpath xlink:href="#myPathL">L<animate attributeName="startOffset" from="10%" to ="83%" begin="0s" dur="8s" fill="freeze"  repeatCount="1" keyTimes="0;1" calcMode="spline" keySplines="0.1 0.2 .22 1"/></textpath></text><text fill="#0000ff" stroke="#000000" stroke-width="1.5"  font-size="55"   transform="rotate(17.594425201416016 184.9999999999999,51.937500000000036) "><textpath xlink:href="#myPathM">M<animate fill="freeze" attributeName="startOffset" from="0%" to ="90%" begin="0s" dur="8s" repeatCount="1" keyTimes="0;1" calcMode="spline" keySplines="0.1 0.2 .22 1"/></textpath></text><path transform="rotate(158.76763916015625 224.5174560546875,177.16561889648435) " stroke="#fff" id="myPathA" d="m225.873938,58.665611l-2.712963,0l0,0c-0.355406,0 -0.643519,53.054281 -0.643519,118.50002c0,65.445716 0.288113,118.499974 0.643519,118.499974l2.712963,0l0,0c0.355406,0 0.643519,-53.054258 0.643519,-118.499974c0,-65.445763 -0.288113,-118.50002 -0.643519,-118.50002z" fill-opacity="null" stroke-opacity="null" stroke-width="0" fill="none"/><path stroke="#000" transform="rotate(156.81285095214844 209.51745605468747,233.66563415527347) " id="myPathB" d="m210.738347,100.393706l-2.441796,0l0,0c-0.319876,0 -0.579188,59.667901 -0.579188,133.271952c0,73.604028 0.259312,133.271907 0.579188,133.271907l2.441796,0l0,0c0.319876,0 0.579197,-59.667878 0.579197,-133.271907c0,-73.604073 -0.259321,-133.271952 -0.579197,-133.271952z" fill-opacity="null" stroke-opacity="null" stroke-width="0" fill="none"/><path d="m259.5,86c0,0 -1,0 -3,0c-1,0 -2,0 -3,0c-1,0 -3.076126,-0.382683 -4,0c-1.306564,0.541199 -1.693436,1.458801 -3,2c-0.923874,0.382683 -2.076126,0.617317 -3,1c-1.306564,0.541199 -2.173096,0.85273 -3,2c-1.307449,1.813995 -3,3 -4,4c-1,1 -1,2 -2,3c-1,1 -2,2 -3,3c-1,1 -1.234634,2.152245 -2,4c-1.082397,2.613129 -3.173096,4.85273 -4,6c-1.307449,1.813995 -1.149353,3.474266 -2,4c-1.902115,1.175568 -0.234634,3.152245 -1,5c-0.541199,1.306564 -1,3 -1,5c0,1 0,3 0,4c0,3 0,5 0,7c0,2 1.458801,3.693436 2,5c0.38269,0.923874 0.458801,1.693436 1,3c0.38269,0.923874 1,2 1,3c0,1 1.61731,1.076126 2,2c0.541199,1.306564 2.418854,2.418854 4,4c1.581146,1.581146 4.906326,3.103409 6,4c2.78833,2.285873 5,3 7,4c2,1 3.097885,2.824432 5,4c0.850647,0.525726 2.097885,1.824432 4,3c0.850647,0.525726 1.852737,0.173096 3,1c1.813995,1.307449 3.076111,2.61731 4,3c2.613129,1.082397 3.61731,3.076126 4,4c1.082397,2.613129 4.466125,6.072571 5,8c1.556488,5.61937 3.432678,10.054138 4,13c1.018372,5.287994 2,9 2,13c0,2 1,4 1,6c0,1 0,2 0,3c0,1 -0.486267,1.823746 -1,4c-0.459503,1.946503 -1.493469,3.878555 -2,7c-0.160187,0.987091 -1,1 -1,2l-1,0l0,1l-1,0" id="myPathM" fill-opacity="null" stroke-opacity="null" stroke-width="0" stroke="#000" fill="none"/><path d="m171.5,224c1,-1 3.076126,-1.61731 4,-2c1.306564,-0.541199 3.186005,-2.692551 5,-4c2.29454,-1.653809 6,-5 8,-6c2,-1 4.053497,-2.540497 6,-3c2.176254,-0.513748 2.693436,-2.458801 4,-3c0.923874,-0.38269 2.053497,0.459503 4,0c2.176254,-0.513748 4,-1 6,-1c2,0 4,0 6,0c3,0 5,0 6,0c3,0 5.152237,-0.765366 7,0c1.306564,0.541199 2.693436,2.458801 4,3c0.923874,0.38269 2.61731,1.076126 3,2c0.541199,1.306564 1.693436,2.458801 3,3c0.923874,0.38269 0.692551,1.186005 2,3c0.826904,1.147263 1.458801,2.693436 2,4c0.38269,0.923874 0.61731,3.076126 1,4c0.541199,1.306564 1,2 1,3c0,1 0.458801,1.693436 1,3c0.38269,0.923874 0,2 0,3c0,2 1,3 1,4c0,1 -0.38269,2.076126 0,3c0.541199,1.306564 1,3 1,4c0,1 0.61731,2.076126 1,3c0.541199,1.306564 1,2 2,3c1,1 1.292892,2.292892 2,3c0.707108,0.707108 0.693436,1.458801 2,2c0.923874,0.38269 1,1 2,1l1,0l1,0" id="myPathD" fill-opacity="null" stroke-opacity="null" stroke-width="0" stroke="#000" fill="none"/><path stroke="#000" d="m9.5,398c0,-0.890806 0,-7.126448 2.755015,-30.287403c2.755015,-23.160955 4.640243,-33.839861 7.346707,-45.431104c1.870258,-8.009941 3.211935,-11.514363 3.673354,-16.034507c0.361963,-3.54588 1.364889,-4.297035 1.836677,-6.235642c0.421979,-1.733956 1.339673,-5.07176 1.836677,-6.235642c0.702865,-1.645985 0.132511,-2.613752 0.918338,-4.45403c1.111329,-2.602552 1.077299,-4.322834 1.836677,-5.344836c1.200681,-1.615918 1.995637,-4.322834 2.755015,-5.344836c1.200681,-1.615918 1.836677,-3.563224 2.755015,-5.344836c0.918338,-1.781612 2.011416,-3.457691 3.673354,-6.235642c1.030693,-1.72281 2.472673,-3.728918 3.673354,-5.344836c2.278134,-3.065979 5.227688,-5.51053 6.428369,-7.126448c1.518756,-2.04399 3.53811,-3.717419 4.591692,-4.45403c1.665862,-1.164684 2.105651,-1.151716 2.755015,-1.781612c0.649364,-0.629896 0.566906,-0.95862 0.918338,-1.781612c0.497004,-1.163895 1.836677,-0.890806 2.755015,-1.781612c0.918338,-0.890806 1.485245,-0.95862 1.836677,-1.781612c0.497004,-1.163895 2.110983,-0.844958 3.673354,-1.781612c1.746785,-1.047203 4.170392,-4.025291 8.265046,-7.126448c12.662017,-9.589811 49.993533,-32.851949 59.691997,-38.304656c14.927848,-8.392777 41.184429,-15.825847 48.671936,-16.925313c16.369085,-2.403651 31.312235,-0.41535 36.733537,0.890806c8.455227,2.037112 13.666281,5.514336 16.530092,7.126448c3.552116,1.999583 7.941324,5.320355 11.938399,6.235642c0.89376,0.204664 2.473499,1.299509 3.673354,1.781612c0.848443,0.340903 1.995637,0.759624 2.755015,1.781612c1.200695,1.615918 2.295286,5.31152 2.755015,14.252895c0.182978,3.558806 0.7355,8.96557 0,13.362089c-0.465167,2.780602 -3.632184,8.506438 -4.591692,11.580477c-0.532232,1.705167 -2.283235,3.406215 -2.755015,5.344836c-0.421979,1.733956 -0.309934,3.839385 -1.836677,6.235642c-0.682784,1.071642 -0.918338,1.781612 -0.918338,2.672418c0,0.890806 -0.918338,1.781612 -0.918338,2.672418c0,0.890806 0,1.781612 0,2.672418l0,0.890806l0,0.890806l0,0.890806" id="myPathL" fill-opacity="null" stroke-opacity="null" stroke-width="0" fill="none"/><rect fill="#bf0000" stroke-width="1.5" stroke-opacity="null" x="246.000981" y="256.872206" width="76.000266" height="535" id="svg_4" stroke="#000"/><ellipse fill="#bf0000" stroke-width="0" stroke-opacity="null" cx="283.002221" cy="263.536607" id="svg_8" rx="35.999012" ry="36.998989" stroke="#000"/><rect fill="#7f0000" stroke-width="1.5" stroke-opacity="null" x="205.99974" y="256.872206" width="40.001242" height="535" id="svg_3" stroke="#000"/><ellipse fill="#7f0000" stroke-width="0" stroke-opacity="null" cx="226.003806" cy="263.536607" id="svg_6" rx="18.999481" ry="36.998989" stroke="#000"/></svg></div>';
      break;
    case 'Play':
      pageHTML += '<div id="containerInfoGame"><div id="play" class="start_page"><div id="playerInfo"><h3>Information about you</h3><label for="namePlayer">Your Name <input type="text" value =' + window.localStorage["UserName"] + ' tabindex="-1" autofocus name="namePlayer" id="namePlayer"></label></div><div id="choise_back"><h3>Cards Back</h3><label for="family"><input  type="radio" name="back" id="family" value="family" checked><img src="images/sprite_back2.svg#family"></label><label for="animals"><input type="radio"  name="back" id="animals" value="animals"><img src="images/sprite_back2.svg#animals"></label><label for="numbers"><input type="radio" name="back" id="numbers" value="numbers"><img src="images/sprite_back2.svg#numbers"></label></div><div id="choice_difficult"><h3>Difficulty Of The Game</h3><input type="radio"  name="difficulty" value="6" id="easy" ><label  for="easy">Easy (6)</label><input type="radio"  name="difficulty" value="12" id="medium" checked><label for="medium">Medium (12)</label><input  type="radio" name="difficulty" value="18" id="hard"><label for="hard">Hard (18)</label></div></div><button id="btn_play" onclick="startPlay()">PLAY</button><div id="timerStepsReset"><div id="steps">Steps <p><span id="numbersOfSteps"></span></p></div><div id="timer">Timer <p><span id="min"></span><span id="sec"></span></p></div></div><div id="board_cards"></div><div id="congratulations"></div></div>';
      break;
    case 'Records':
      pageHTML += "<table id='table_records'><tr><td>Player</td><td>Difficulty</td><td>Time</td><td>Steps</td></tr>";
      if (Storage.length > 10) Storage.length = 10;
      for (var i = 0; i < Storage.length; i++) {
        pageHTML += '<tr><td>' + Storage[i].name + '</td><td>Easy</td><td class="Name"> ' + Storage[i].score + ' sec </td><td>' + Storage[i].steps + '</td></tr>';
      }
      pageHTML += "</table>"
      break;
    case 'Description':
      pageHTML += '<div id="description" class="start_page"><p class="description_game"><img class="butterfly but1" src="images/butterfly.png"><img class="butterfly but2"src="images/butterfly.png"><img class="butterfly but3"src="images/butterfly.png"><img class="butterfly but4"src="images/butterfly.png">Наше приложение разработано специально для детишек в возрасте от двух лет. Игра позволяет тренировать память, запоминать новые слова. Выбирая рубашку карт, вы определяете и рубрику тем карточек-перевертышей. Постепенно натренировав свою память, можно также и увеличивать уровень сложности. <br>Управление игрой осуществляется мышкой. Доступны след. комбинации клавиш для переключения между закладками: Alt+1(&laquo;Главная страница&raquo;), Alt+2(&laquo;Выбор игры&raquo;), Alt+3(&laquo;Рекорды&raquo;), Alt+4(&laquo;Описание приложения&raquo;).</p></div>';
      break;
  }
  document.getElementById('start_page').innerHTML = pageHTML;
}
function userName() {
  if (window.localStorage["UserName"] == undefined) {
    window.localStorage["UserName"] = "User";
  }
}
userName();
function switchToState(newState) {
  var stateStr = newState.pagename;
  location.hash = stateStr;
}

function switchToMainPage() {
  switchToState({ pagename: 'Main' });
}

function switchToGamePage() {
  switchToState({ pagename: 'Play' });
}

function switchToRecordsPage() {
  switchToState({ pagename: 'Records' });
}

function switchToDescriptionPage() {
  switchToState({ pagename: 'Description' });
}

window.addEventListener('hashchange', switchToStateFromURLHash, false);
switchToStateFromURLHash();